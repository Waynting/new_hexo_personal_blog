# å¦‚ä½•æ’°å¯«æ–‡ç« 

å®Œæ•´æŒ‡å—ï¼šå¾å‰µå»ºæ–‡ç« åˆ°ä¸Šå‚³åœ–ç‰‡åˆ° R2

**ä½œè€…ï¼š** Wei-Ting Liu

---

## å¿«é€Ÿé–‹å§‹

### 1. å‰µå»ºæ–°æ–‡ç« 

åœ¨ `content/` ç›®éŒ„ä¸‹æŒ‰ç…§å¹´ä»½/æœˆä»½å‰µå»º `.md` æ–‡ä»¶ï¼š

```bash
# ç¯„ä¾‹ï¼šå‰µå»º 2025 å¹´ 11 æœˆçš„æ–‡ç« 
content/2025/11/my-new-post.md
```

**ç›®éŒ„çµæ§‹ï¼š**
```
content/
â”œâ”€â”€ 2025/
â”‚   â”œâ”€â”€ 11/
â”‚   â”‚   â”œâ”€â”€ my-new-post.md
â”‚   â”‚   â””â”€â”€ another-post.md
â”‚   â””â”€â”€ 10/
â”‚       â””â”€â”€ old-post.md
```

### 2. æ–‡ç«  Frontmatterï¼ˆå¿…å¡«ï¼‰

æ¯ç¯‡æ–‡ç« é–‹é ­å¿…é ˆåŒ…å« frontmatterï¼ˆYAML æ ¼å¼ï¼‰ï¼š

```markdown
---
title: "æ–‡ç« æ¨™é¡Œ"
date: 2025-11-01
tags:
  - æ¨™ç±¤1
  - æ¨™ç±¤2
categories:
  - åˆ†é¡åç¨±
---
```

**Frontmatter æ¬„ä½èªªæ˜ï¼š**

| æ¬„ä½ | å¿…å¡« | èªªæ˜ | ç¯„ä¾‹ |
|------|------|------|------|
| `title` | âœ… | æ–‡ç« æ¨™é¡Œ | `"æˆ‘çš„ç¬¬ä¸€ç¯‡æ–‡ç« "` |
| `date` | âœ… | ç™¼å¸ƒæ—¥æœŸ | `2025-11-01` æˆ– `Fri Nov 01 2025 12:00:00 GMT+0800` |
| `tags` | âŒ | æ¨™ç±¤åˆ—è¡¨ï¼ˆé™£åˆ—ï¼‰ | `["æŠ€è¡“", "Next.js"]` |
| `categories` | âœ… | åˆ†é¡ï¼ˆé™£åˆ—ï¼Œç¬¬ä¸€å€‹ç‚ºä¸»åˆ†é¡ï¼‰ | `["æŠ€è¡“ç­†è¨˜"]` |
| `coverImage` | âŒ | å°é¢åœ–ç‰‡å®Œæ•´ URL æˆ–ç›¸å°è·¯å¾‘ | `"https://img.waynspace.com/2025/11/my-post/cover.webp"` æˆ– `"./cover.jpg"` |
| `author` | âŒ | ä½œè€…è³‡è¨Š | `name: Wei-Ting Liu`ï¼ˆé è¨­å€¼ï¼‰ |

**âš ï¸ é‡è¦ï¼š**
- å¦‚æœæ²’æœ‰è¨­å®š `coverImage`ï¼Œç³»çµ±æœƒ**è‡ªå‹•æå–æ–‡ç« ä¸­çš„ç¬¬ä¸€å¼µåœ–ç‰‡**ä½œç‚ºå°é¢
- æ–‡ç« æª”åæœƒè‡ªå‹•æˆç‚º URL slugï¼ˆä¸å« `.md` å‰¯æª”åï¼‰
- æª”åä¸­çš„ç©ºæ ¼æœƒè‡ªå‹•æ›¿æ›ç‚ºé€£å­—è™Ÿï¼ˆä¾‹å¦‚ï¼š`ç©ºé–“æ¢ç´¢ 20251130.md` â†’ `ç©ºé–“æ¢ç´¢-20251130`ï¼‰
- å¦‚æœæ²’æœ‰è¨­å®š `author`ï¼Œé è¨­ä½œè€…ç‚º `Wei-Ting Liu`

<hr>

## åœ–ç‰‡è™•ç†

### åœ–ç‰‡è·¯å¾‘è¦å‰‡

ä½ çš„ R2 bucket çµæ§‹ï¼š
```
blog-post/           â† R2 bucket åç¨±
â”œâ”€â”€ 2025/
â”‚   â”œâ”€â”€ 11/
â”‚   â”‚   â””â”€â”€ my-new-post/
â”‚   â”‚       â”œâ”€â”€ image1.webp
â”‚   â”‚       â””â”€â”€ image2.jpg
â”‚   â””â”€â”€ 10/
â”‚       â””â”€â”€ old-post/
â”‚           â””â”€â”€ photo.png
```

**å…¬é–‹è¨ªå• URL æ ¼å¼ï¼š**
```
https://img.waynspace.com/{year}/{month}/{slug}/{filename}
```

**ç¯„ä¾‹ï¼š**
```
https://img.waynspace.com/2025/11/my-new-post/image1.webp
```

âš ï¸ **æ³¨æ„ï¼š**
- URL ä¸­ä¸åŒ…å« `blog-post` å‰ç¶´ï¼ˆå› ç‚ºå®ƒæ˜¯ bucket åç¨±ï¼Œå·²ç¶“åœ¨ Cloudflare é…ç½®ä¸­ç¶å®šåˆ°åŸŸåï¼‰
- æª”åä¸­çš„ç©ºæ ¼æœƒè‡ªå‹•æ›¿æ›ç‚ºé€£å­—è™Ÿï¼ˆä¾‹å¦‚ï¼š`ç©ºé–“æ¢ç´¢ 20251130` â†’ `ç©ºé–“æ¢ç´¢-20251130`ï¼‰

### æ–¹æ³• 1ï¼šä½¿ç”¨ç›¸å°è·¯å¾‘ï¼ˆæ¨è–¦ï¼‰â­

**æ¨è–¦æ–¹å¼**ï¼šå°‡åœ–ç‰‡æ”¾åœ¨æ–‡ç« åŒç›®éŒ„ä¸‹ï¼Œä½¿ç”¨ç›¸å°è·¯å¾‘ï¼Œç„¶å¾ŒåŸ·è¡Œè‡ªå‹•è™•ç†è…³æœ¬ã€‚

```markdown
---
title: "æˆ‘çš„æ–°æ–‡ç« "
date: 2025-11-01
categories:
  - æŠ€è¡“ç­†è¨˜
coverImage: "./cover.jpg"
author:
  name: Wei-Ting Liu
  email: wayntingliu@gmail.com
---

é€™æ˜¯æ–‡ç« å…§å®¹ã€‚

![åœ–ç‰‡æè¿°](./image1.jpg)
![å¦ä¸€å¼µåœ–](./image2.png)
```

**ç›®éŒ„çµæ§‹**ï¼š
```
content/2025/11/my-new-post/
â”œâ”€â”€ my-new-post.md
â”œâ”€â”€ cover.jpg
â”œâ”€â”€ image1.jpg
â””â”€â”€ image2.png
```

**åŸ·è¡Œè™•ç†**ï¼š
```bash
npm run images:process
```

**çµæœ**ï¼š
- âœ… åœ–ç‰‡è‡ªå‹•è½‰æ›ç‚º WebP æ ¼å¼
- âœ… è‡ªå‹•å£“ç¸®åœ–ç‰‡
- âœ… è‡ªå‹•ä¸Šå‚³åˆ° R2
- âœ… è·¯å¾‘è‡ªå‹•æ›´æ–°ç‚º CDN URL
- âœ… æœ¬åœ°åœ–ç‰‡è‡ªå‹•åˆªé™¤

### æ–¹æ³• 2ï¼šç›´æ¥ä½¿ç”¨å®Œæ•´ URL

å¦‚æœä½ å·²ç¶“æ‰‹å‹•ä¸Šå‚³åœ–ç‰‡åˆ° R2ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨å®Œæ•´ URLï¼š

```markdown
---
title: "æˆ‘çš„æ–°æ–‡ç« "
date: 2025-11-01
categories:
  - æŠ€è¡“ç­†è¨˜
coverImage: "https://img.waynspace.com/2025/11/my-new-post/cover.webp"
---

![åœ–ç‰‡æè¿°](https://img.waynspace.com/2025/11/my-new-post/image1.webp)
```

**å„ªé»ï¼š**
- âœ… æ˜ç¢ºã€ä¸æœƒå‡ºéŒ¯
- âœ… ä¸éœ€è¦é¡å¤–è™•ç†

**ç¼ºé»ï¼š**
- âŒ éœ€è¦æ‰‹å‹•ä¸Šå‚³åœ–ç‰‡
- âŒ éœ€è¦æ‰‹å‹•æ§‹å»º URL

<hr>

## åœ–ç‰‡ä¸Šå‚³åˆ° R2

### æ¨è–¦æ–¹å¼ï¼šä½¿ç”¨è‡ªå‹•è™•ç†è…³æœ¬ â­

**é€™æ˜¯æœ€ç°¡å–®ã€æœ€å¯é çš„æ–¹å¼ï¼**

**1. å°‡åœ–ç‰‡æ”¾åœ¨æ–‡ç« åŒç›®éŒ„ä¸‹**ï¼š

```bash
content/2025/11/my-new-post/
â”œâ”€â”€ my-new-post.md
â”œâ”€â”€ cover.jpg
â”œâ”€â”€ screenshot1.png
â””â”€â”€ photo.jpg
```

**2. åœ¨æ–‡ç« ä¸­ä½¿ç”¨ç›¸å°è·¯å¾‘**ï¼š

```markdown
---
title: "æˆ‘çš„æ–°æ–‡ç« "
date: 2025-11-01
categories:
  - æŠ€è¡“ç­†è¨˜
coverImage: "./cover.jpg"
---

![å°é¢](./cover.jpg)
![æˆªåœ–](./screenshot1.png)
![ç…§ç‰‡](./photo.jpg)
```

**3. åŸ·è¡Œè‡ªå‹•è™•ç†è…³æœ¬**ï¼š

```bash
npm run images:process
```

**è…³æœ¬æœƒè‡ªå‹•å®Œæˆï¼š**
- âœ… è½‰æ›åœ–ç‰‡ç‚º WebP æ ¼å¼
- âœ… å£“ç¸®åœ–ç‰‡ï¼ˆç¯€çœç©ºé–“ï¼‰
- âœ… ä¸Šå‚³åˆ° R2
- âœ… æ›¿æ›æ–‡ç« ä¸­çš„è·¯å¾‘ç‚º CDN URL
- âœ… æ¸…ç†æ–‡ä»¶åä¸­çš„ç©ºæ ¼
- âœ… åˆªé™¤æœ¬åœ°åœ–ç‰‡

**4. çµæœ**ï¼š

æ–‡ç« ä¸­çš„è·¯å¾‘æœƒè‡ªå‹•æ›´æ–°ç‚ºï¼š
```markdown
![å°é¢](https://img.waynspace.com/2025/11/my-new-post/cover.webp)
![æˆªåœ–](https://img.waynspace.com/2025/11/my-new-post/screenshot1.webp)
![ç…§ç‰‡](https://img.waynspace.com/2025/11/my-new-post/photo.webp)
```

**è©³ç´°èªªæ˜è«‹åƒè€ƒ `docs/åœ–ç‰‡ä¸Šå‚³æŒ‡å—.md` å’Œ `scripts/README.md`**

<hr>

### å‰ç½®ä½œæ¥­ï¼šé…ç½®ç’°å¢ƒè®Šæ•¸

**å‰µå»º `.env` æª”æ¡ˆ**ï¼š

è¤‡è£½ `.env.example` ä¸¦å¡«å…¥å¯¦éš›å€¼ï¼š

```bash
cp .env.example .env
```

ç·¨è¼¯ `.env`ï¼š
```env
# Cloudflare R2 é…ç½®
CF_ACCOUNT_ID=ä½ çš„å¸³è™ŸID
R2_BUCKET=blog-post
R2_BASE_URL=https://img.waynspace.com

# R2 API æ†‘è­‰ï¼ˆç”¨æ–¼ç›´æ¥ä¸Šå‚³ï¼‰
R2_ACCESS_KEY_ID=ä½ çš„AccessKeyID
R2_SECRET_ACCESS_KEY=ä½ çš„SecretAccessKey
```

**ç²å– R2 API æ†‘è­‰**ï¼š
1. å‰å¾€ [Cloudflare Dashboard](https://dash.cloudflare.com/)
2. é¸æ“‡ R2 > Manage R2 API Tokens
3. å‰µå»ºæ–°çš„ API Token
4. è¤‡è£½ Access Key ID å’Œ Secret Access Key

<hr>

## å®Œæ•´ç¯„ä¾‹

### ç¯„ä¾‹æ–‡ç« ï¼š`content/2025/11/nextjs-tutorial.md`

**ç›®éŒ„çµæ§‹**ï¼š
```
content/2025/11/nextjs-tutorial/
â”œâ”€â”€ nextjs-tutorial.md
â”œâ”€â”€ cover.jpg
â”œâ”€â”€ nextjs-logo.png
â””â”€â”€ installation.png
```

**æ–‡ç« å…§å®¹**ï¼š
```markdown
---
title: "Next.js 15 å®Œæ•´æ•™å­¸"
date: 2025-11-01
tags:
  - Next.js
  - React
  - æ•™å­¸
categories:
  - æŠ€è¡“ç­†è¨˜
coverImage: "./cover.jpg"
author:
  name: Wei-Ting Liu
  email: wayntingliu@gmail.com
---

## ä»€éº¼æ˜¯ Next.jsï¼Ÿ

Next.js æ˜¯ä¸€å€‹åŸºæ–¼ React çš„å…¨ç«¯æ¡†æ¶...

![Next.js Logo](./nextjs-logo.png)

## å®‰è£èˆ‡è¨­å®š

é¦–å…ˆå®‰è£ Next.jsï¼š

\```bash
npx create-next-app@latest
\```

![å®‰è£éç¨‹](./installation.png)

## ç¸½çµ

é€™ç¯‡æ–‡ç« ä»‹ç´¹äº† Next.js çš„åŸºç¤æ¦‚å¿µ...
```

**åŸ·è¡Œè™•ç†**ï¼š
```bash
npm run images:process
```

**çµæœ**ï¼š
- åœ–ç‰‡è‡ªå‹•ä¸Šå‚³åˆ°ï¼š`blog-post/2025/11/nextjs-tutorial/`
- è·¯å¾‘è‡ªå‹•æ›´æ–°ç‚º CDN URL
- æœ¬åœ°åœ–ç‰‡è‡ªå‹•åˆªé™¤

<hr>

## å¸¸è¦‹åˆ†é¡

ç³»çµ±é è¨­çš„åˆ†é¡åŠå…¶å°æ‡‰é¡è‰²ï¼š

| åˆ†é¡ | é¡è‰² |
|------|------|
| å°å¤§è³‡ç®¡ç”Ÿæ´» | è—è‰² |
| ç§‘å­¸ç­ç”Ÿæ´» | ç´«è‰² |
| æ”å½±ç­†è¨˜ | ç¶ è‰² |
| åŸå¸‚æ¼«æ­¥ | é»ƒè‰² |
| ç”Ÿæ´»æ—¥èªŒ | ç²‰ç´…è‰² |
| è®€æ›¸ç­†è¨˜èˆ‡å¿ƒå¾— | é›è—è‰² |
| æŠ€è¡“ç­†è¨˜ | ç´…è‰² |

<hr>

## æ¸¬è©¦èˆ‡é©—è­‰

### æœ¬åœ°æ¸¬è©¦

```bash
# å•Ÿå‹•é–‹ç™¼ä¼ºæœå™¨
npm run dev

# è¨ªå•æ–‡ç« 
http://localhost:3000/blog/2025/11/nextjs-tutorial
```

### é©—è­‰åœ–ç‰‡

```bash
# ä½¿ç”¨é©—è­‰è…³æœ¬æª¢æŸ¥æ‰€æœ‰åœ–ç‰‡
npm run images:verify

# æˆ–æ‰‹å‹•æ¸¬è©¦å–®å¼µåœ–ç‰‡ URL
curl -I "https://img.waynspace.com/2025/11/nextjs-tutorial/cover.webp"
```

### å¸¸è¦‹å•é¡Œæ’æŸ¥

**1. åœ–ç‰‡é¡¯ç¤º 404**
- âœ… åŸ·è¡Œ `npm run images:verify` æª¢æŸ¥åœ–ç‰‡æ˜¯å¦å­˜åœ¨
- âœ… æª¢æŸ¥ URL æ ¼å¼æ˜¯å¦æ­£ç¢ºï¼ˆ`https://img.waynspace.com/YYYY/MM/slug/image.webp`ï¼‰
- âœ… ç¢ºèª Cloudflare R2 å·²å•Ÿç”¨ Public Access

**2. åœ–ç‰‡é¡¯ç¤º 403**
- âœ… å‰å¾€ Cloudflare Dashboard > R2 > ä½ çš„ bucket > Settings
- âœ… å•Ÿç”¨ "Public Access"
- âœ… ç¢ºèªè‡ªå®šç¾©åŸŸå `img.waynspace.com` å·²æ­£ç¢ºç¶å®š

**3. å°é¢åœ–ç‰‡æ²’æœ‰é¡¯ç¤º**
- âœ… æª¢æŸ¥ frontmatter ä¸­çš„ `coverImage` æ˜¯å¦æ­£ç¢º
- âœ… å¦‚æœæ²’è¨­å®šï¼Œç¢ºèªæ–‡ç« ä¸­è‡³å°‘æœ‰ä¸€å¼µåœ–ç‰‡ï¼ˆç³»çµ±æœƒè‡ªå‹•æå–ï¼‰

**4. åœ–ç‰‡è·¯å¾‘åŒ…å«ç©ºæ ¼å°è‡´ç„¡æ³•è¨ªå•**
- âœ… ä½¿ç”¨ `npm run images:process` æœƒè‡ªå‹•æ¸…ç†ç©ºæ ¼
- âœ… æˆ–ä½¿ç”¨ `npm run images:delete-spaces` åˆªé™¤ R2 ä¸ŠåŒ…å«ç©ºæ ¼çš„æ–‡ä»¶

<hr>

## å¿«é€Ÿæª¢æŸ¥æ¸…å–®

æ’°å¯«æ–°æ–‡ç« å‰ï¼š

- [ ] ç¢ºèªæ–‡ç« è·¯å¾‘ï¼š`content/YYYY/MM/slug.md`
- [ ] frontmatter åŒ…å«ï¼štitleã€dateã€categories
- [ ] åœ–ç‰‡æ”¾åœ¨æ–‡ç« åŒç›®éŒ„ä¸‹ï¼Œä½¿ç”¨ç›¸å°è·¯å¾‘ï¼š`./image.jpg`
- [ ] åŸ·è¡Œ `npm run images:process` è™•ç†åœ–ç‰‡
- [ ] ç¢ºèªåœ–ç‰‡è·¯å¾‘å·²æ›´æ–°ç‚º CDN URL
- [ ] æœ¬åœ°æ¸¬è©¦ï¼š`npm run dev`
- [ ] ç¢ºèªåœ–ç‰‡å¯æ­£å¸¸è¨ªå•
- [ ] æäº¤æ–‡ç« åˆ° Gitï¼ˆä¸æäº¤æœ¬åœ°åœ–ç‰‡ï¼‰

<hr>

## ğŸ’¡ æœ€ä½³å¯¦è¸

1. **ä½¿ç”¨è‡ªå‹•è™•ç†è…³æœ¬**ï¼š`npm run images:process` æ˜¯æœ€æ–¹ä¾¿çš„æ–¹å¼
2. **å°‡åœ–ç‰‡æ”¾åœ¨æ–‡ç« åŒç›®éŒ„ä¸‹**ï¼šæ–¹ä¾¿ç®¡ç†ï¼Œè™•ç†å¾Œè‡ªå‹•åˆªé™¤
3. **ä½¿ç”¨ç›¸å°è·¯å¾‘**ï¼š`./image.jpg` æ¯”çµ•å°è·¯å¾‘æ›´æ–¹ä¾¿
4. **å®šæœŸé©—è­‰**ï¼šä½¿ç”¨ `npm run images:verify` æª¢æŸ¥åœ–ç‰‡æ˜¯å¦æ­£ç¢º
5. **è™•ç†å®Œæˆå¾Œåˆªé™¤æœ¬åœ°åœ–ç‰‡**ï¼šè…³æœ¬æœƒè‡ªå‹•è™•ç†ï¼Œä¿æŒç›®éŒ„æ•´æ½”

<hr>

## åƒè€ƒè³‡æº

- [Next.js å®˜æ–¹æ–‡æª”](https://nextjs.org/docs)
- [Cloudflare R2 æ–‡æª”](https://developers.cloudflare.com/r2/)
- [rclone å®˜æ–¹æ–‡æª”](https://rclone.org/docs/)
- [Markdown èªæ³•](https://www.markdownguide.org/)

<hr>

**æ’°å¯«æ„‰å¿«ï¼** ğŸ‰
